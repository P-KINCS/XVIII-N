<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Mission 29 // Tje Letters You Never Sent</title>
<style>
  :root{
    --night:#001f3f;
    --gold:#d4af37;
    --ink:#f5e6b1;
  }
  html,body{margin:0;background:var(--night);color:var(--gold);
    font-family:"Garamond",serif;overflow-x:hidden}
  .wrap{max-width:900px;margin:0 auto;padding:36px 18px;position:relative;z-index:2;text-align:center}
  h1{letter-spacing:1px;margin-bottom:8px}
  p.intro{color:var(--ink);opacity:.9;line-height:1.6;margin:0 0 28px}
  blockquote{margin:10px auto;padding:0 14px;border-left:2px solid rgba(212,175,55,.35);
    color:var(--ink);max-width:700px;text-align:left}
  .card{
    background:rgba(255,255,255,.04);
    border:1px solid rgba(212,175,55,.25);
    border-radius:12px;
    padding:18px 16px;
    margin:24px auto;
    max-width:750px;
  }
  input{
    border:1px solid rgba(212,175,55,.6);
    background:#0a223d;
    color:var(--ink);
    border-radius:8px;
    padding:10px 14px;
    font-size:16px;
    min-width:260px;
    text-align:center;
    margin-top:10px;
  }
  .btn{
    border:1px solid var(--gold);
    color:var(--gold);
    background:transparent;
    border-radius:8px;
    padding:8px 14px;
    cursor:pointer;
    margin-top:10px;
  }
  .btn:hover{background:rgba(212,175,55,.08)}
  .handwrite{
    font-family:"Great Vibes","Brush Script MT",cursive;
    font-size:26px;
    color:var(--gold);
    margin-top:16px;
    white-space:pre-wrap;
  }
  .hidden{display:none}
  .fadein{animation:fadeIn 2s ease forwards}
  @keyframes fadeIn{from{opacity:0}to{opacity:1}}

  /* pulsating lilies */
  .lilies{position:fixed;inset:0;pointer-events:none;z-index:1}
  .lily{
    position:absolute;color:var(--gold);opacity:.4;
    filter:drop-shadow(0 0 6px rgba(212,175,55,.7));
    animation:pulse var(--spd) ease-in-out infinite;
  }
  @keyframes pulse{
    0%,100%{transform:scale(.9);opacity:.35}
    50%{transform:scale(1.1);opacity:.9}
  }

  #finalBlock{display:none;margin-top:40px}
  #finalBlock p{font-style:italic;color:var(--ink)}
  a.next{
    display:inline-block;margin-top:16px;
    color:var(--gold);text-decoration:none;
    border-bottom:1px dotted var(--gold);
    padding-bottom:2px;
  }
  a.next:hover{opacity:.85}

  /* overlay for step 2 */
  #step2{display:none;position:fixed;inset:0;background:rgba(0,0,0,.7);
    z-index:5;overflow:auto;text-align:center;padding-top:60px}
  #step2 p{color:var(--ink);font-size:18px}
  #step2 input{margin:12px 0}
</style>
</head>
<body>
<div class="lilies" id="lilies"></div>

<div class="wrap" id="main">
  <h1>Mission 29 // Tje Letters You Never Sent</h1>
  <p class="intro">
    Some words were never meant to be spoken — only found.<br>
    Let’s see if you can trace the hearts behind these lines.
  </p>

  <!-- 1 -->
  <div class="card" id="c1">
    <blockquote>
      How do I love thee? Let me count the ways.<br>
      I love thee to the depth and breadth and height<br>
      My soul can reach, when feeling out of sight<br>
      For the ends of Being and ideal Grace.
    </blockquote>
    <input id="w1" type="text" placeholder="Writer">
    <div><button class="btn" onclick="check(1,['elizabeth','barrett','browning'])">Confirm</button></div>
    <div class="handwrite hidden" id="m1"></div>
  </div>

  <!-- 2 -->
  <div class="card hidden" id="c2">
    <blockquote>
      I love you as certain dark things are to be loved,<br>
      in secret, between the shadow and the soul.<br>
      I love you as the plant that never blooms<br>
      but carries in itself the light of hidden flowers.
    </blockquote>
    <input id="w2" type="text" placeholder="Writer">
    <div><button class="btn" onclick="check(2,['pablo','neruda'])">Confirm</button></div>
    <div class="handwrite hidden" id="m2"></div>
  </div>

  <!-- 3 -->
  <div class="card hidden" id="c3">
    <blockquote>
      She walks in beauty, like the night<br>
      Of cloudless climes and starry skies;<br>
      And all that’s best of dark and bright<br>
      Meet in her aspect and her eyes.
    </blockquote>
    <input id="w3" type="text" placeholder="Writer">
    <div><button class="btn" onclick="check(3,['lord','byron','george','gordon'])">Confirm</button></div>
    <div class="handwrite hidden" id="m3"></div>
  </div>

  <!-- 4 -->
  <div class="card hidden" id="c4">
    <blockquote>
      i carry your heart with me(i carry it in my heart)<br>
      i am never without it(anywhere i go you go,my dear)<br>
      and whatever is done by only me is your doing,my darling)
    </blockquote>
    <input id="w4" type="text" placeholder="Writer">
    <div><button class="btn" onclick="check(4,['e','e','cummings'])">Confirm</button></div>
    <div class="handwrite hidden" id="m4"></div>
  </div>

  <!-- 5 -->
  <div class="card hidden" id="c5">
    <blockquote>
      Bright star, would I were steadfast as thou art—<br>
      Not in lone splendour hung aloft the night,<br>
      …<br>
      Still, still to hear her tender-taken breath,<br>
      And so live ever—or else swoon to death.
    </blockquote>
    <input id="w5" type="text" placeholder="Writer">
    <div><button class="btn" onclick="check(5,['john','keats'])">Confirm</button></div>
    <div class="handwrite hidden" id="m5"></div>
  </div>

  <div id="finalBlock">
    <p><i>Some truths are written between the lines.</i></p>
    <a href="#" class="next" onclick="openStep2();return false;">Next →</a>
  </div>
</div>

<!-- Step 2 -->
<div id="step2">
  <p>Do you know who M is?</p>
  <input id="ans1" type="text">
  <div><button class="btn" onclick="q2()">Confirm</button></div>

  <div id="q2Block" class="hidden">
    <p>And what about the Agency?</p>
    <input id="ans2" type="text">
    <div><button class="btn" onclick="endMsg()">Confirm</button></div>
  </div>

  <div id="ending" class="handwrite hidden" style="max-width:800px;margin:30px auto;white-space:pre-wrap;"></div>
</div>

<script>
function norm(s){return (s||'').toLowerCase()
  .normalize('NFD').replace(/[\u0300-\u036f]/g,'')
  .replace(/[^a-z0-9\s]/g,' ').replace(/\s+/g,' ').trim();}

function typewrite(el,txt,spd=40){el.textContent='';let i=0;(function step(){if(i<=txt.length){el.textContent=txt.slice(0,i);i++;setTimeout(step,spd);}})();}

const msgs=[
"If I started counting, I’d never finish. — M",
"Some loves aren’t meant to be seen — only felt. — M",
"You never needed the light — you were it. — M",
"I know the feeling — I’ve been carrying yours too. — M",
"If you only knew how long I’ve been wishing the same. — M"
];

function check(i,words){
  const val=norm(document.getElementById('w'+i).value);
  const ok=words.some(w=>val.includes(norm(w)));
  if(!ok){alert('Not quite, Agent. Try again.');return;}
  const inp=document.getElementById('w'+i);
  inp.disabled=true;
  const msg=document.getElementById('m'+i);
  msg.classList.remove('hidden');
  typewrite(msg,msgs[i-1],45);
  const next=document.getElementById('c'+(i+1));
  if(next){setTimeout(()=>{next.classList.remove('hidden');next.scrollIntoView({behavior:'smooth'});},2500);}
  else{setTimeout(()=>{document.getElementById('finalBlock').style.display='block';},2500);}
}

/* lilies */
(function lilies(){
  const host=document.getElementById('lilies');const N=35;
  for(let i=0;i<N;i++){
    const s=document.createElement('span');
    s.className='lily';s.textContent='⚜';
    s.style.left=Math.random()*100+'vw';
    s.style.top=Math.random()*100+'vh';
    s.style.fontSize=(12+Math.random()*22)+'px';
    s.style.opacity=(.3+Math.random()*.6).toFixed(2);
    s.style.setProperty('--spd',(2+Math.random()*3)+'s');
    host.appendChild(s);
  }
})();

function openStep2(){document.getElementById('step2').style.display='block';}
function q2(){document.getElementById('q2Block').classList.remove('hidden');}
function endMsg(){
  const e=document.getElementById('ending');
  e.classList.remove('hidden');
  typewrite(e,"By now, you’ve probably realized…\nI designed all of this not to test your mind — but to remember your heart.\nEvery code, every mission, every word — was a way to say\nwhat I never could out loud.\n\nBecause love is the only mystery worth solving.\n\n— M",45);
}
</script>
</body>
</html>
